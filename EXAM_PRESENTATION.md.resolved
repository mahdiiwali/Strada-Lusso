# Strada-Lusso - Comprehensive Exam Presentation

**Student:** Mehdi Ouali  
**Matricola:** 345791  
**Project:** Individual Flutter Android Application  
**Backend:** Firebase Cloud Firestore

---

## ğŸ“± App Overview

**Strada-Lusso** is a premium luxury car rental application built with Flutter that allows users to:
- Browse a collection of high-end luxury vehicles
- View detailed specifications for each car
- Search and filter cars by category
- Save favorite cars for quick access
- View comprehensive car details including performance metrics

The app provides an elegant, dark-themed interface designed for car enthusiasts with real-time data synchronization through Firebase.

---

## ğŸ—ï¸ Architecture

The application follows **Clean Architecture** principles with clear separation of concerns across three main layers:

```mermaid
graph TB
    subgraph Presentation["ğŸ¨ Presentation Layer"]
        UI[UI Pages & Widgets]
        BLoC[BLoC State Management]
    end
    
    subgraph Domain["ğŸ’¼ Domain Layer"]
        UC[Use Cases]
        Repo[Repository Interface]
    end
    
    subgraph Data["ğŸ“¦ Data Layer"]
        RepoImpl[Repository Implementation]
        DataSource[Firebase Data Source]
        Model[Data Models]
    end
    
    subgraph External["â˜ï¸ External"]
        Firebase[Firebase Firestore]
    end
    
    UI --> BLoC
    BLoC --> UC
    UC --> Repo
    Repo -.implements.-> RepoImpl
    RepoImpl --> DataSource
    DataSource --> Firebase
    Model -.used by.-> DataSource
```

### Layer Breakdown

#### 1. **Presentation Layer** (`lib/presentation/`)
- **Pages:** Screen-level widgets (Onboarding, Car List, Car Details, Search, Favorites)
- **Widgets:** Reusable UI components (CarCard, MoreCarCards)
- **BLoC:** State management using the BLoC pattern (CarBloc, CarEvent, CarState)

#### 2. **Domain Layer** (`lib/domain/`)
- **Use Cases:** Business logic (GetCars)
- **Repository Interface:** Abstract contract for data operations

#### 3. **Data Layer** (`lib/data/`)
- **Models:** Data structures (Car model)
- **Data Sources:** Firebase data access (FirebaseDataCarSource)
- **Repository Implementation:** Concrete implementation of domain repository

---

## ğŸ”¥ Firebase Integration

### Why Firebase Firestore?

Firebase Firestore was chosen because it provides:
- **Real-time synchronization** - automatic updates when data changes
- **No server setup** - fully managed backend
- **Offline support** - data caching for offline access
- **Scalability** - handles growth automatically
- **Flutter integration** - official SDK with excellent support

### Firebase Setup

The app initializes Firebase in [main.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/main.dart):

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(options: DefaultFirebaseOptions.currentPlatform);
  initInjection();
  runApp(const MyApp());
}
```

### Data Structure

Cars are stored in Firestore under the `cars` collection with this structure:

```
cars (collection)
â”œâ”€â”€ document1
â”‚   â”œâ”€â”€ model: "Porsche 911 Turbo S"
â”‚   â”œâ”€â”€ category: "Sports Car"
â”‚   â”œâ”€â”€ price: 150.0
â”‚   â”œâ”€â”€ maxSpeed: "330 km/h"
â”‚   â”œâ”€â”€ acceleration: "2.7s (0-100 km/h)"
â”‚   â”œâ”€â”€ transmission: "8-Speed PDK"
â”‚   â”œâ”€â”€ seats: 4
â”‚   â”œâ”€â”€ fuelCapacity: 64.0
â”‚   â”œâ”€â”€ distance: 120.0
â”‚   â”œâ”€â”€ imageUrl: "https://..."
â”‚   â”œâ”€â”€ ownerName: "John Doe"
â”‚   â”œâ”€â”€ ownerPhone: "+1234567890"
â”‚   â”œâ”€â”€ ownerRating: 4.8
â”‚   â””â”€â”€ ownerReviews: 124
```

---

## ğŸ¯ Key Features Explained

### 1. **Category Filtering**

Users can filter cars by category (All, Luxury Sedan, Sports Sedan, Sports Car, Supercar, Luxury SUV).

**Implementation:** [car_list_screen.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/pages/car_list_screen.dart#L219-L226)

```dart
final filteredCars = _selectedCategory == 'All'
    ? cars
    : cars.where((car) => car.category == _selectedCategory).toList();
```

The category is stored in the `Car` model and each car card is filtered based on the selected category chip.

### 2. **Favorites System**

Users can mark cars as favorites by tapping the heart icon. The favorites are stored in a `Set<String>` that tracks car models.

**Implementation:** [car_list_screen.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/pages/car_list_screen.dart#L28)

```dart
final Set<String> _favoriteCars = {}; // Track favorite car models

// Toggle favorite
onFavoriteToggle: () {
  setState(() {
    if (_favoriteCars.contains(car.model)) {
      _favoriteCars.remove(car.model);
    } else {
      _favoriteCars.add(car.model);
    }
  });
}
```

The favorites state is passed to child pages (Search, Favorites) to maintain consistency across screens.

### 3. **Search Functionality**

A dedicated search page allows users to find cars by name or brand.

**Navigation:** From the bottom navigation bar, users tap the search icon to access `CarSearchPage`.

### 4. **Bottom Navigation**

Four navigation options:
- **Home** - Main car list
- **Search** - Find specific cars
- **My Rentals** - Coming soon feature (shows dialog)
- **My Favorite** - View saved favorites

---

## ğŸ§© State Management with BLoC

The app uses the **BLoC (Business Logic Component)** pattern for state management.

### BLoC Components

#### Events ([car_event.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/bloc/car_event.dart))

```dart
abstract class CarEvent {}

class LoadCarsEvent extends CarEvent {}
```

Events trigger actions in the BLoC.

#### States ([car_state.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/bloc/car_state.dart))

```dart
abstract class CarState {}

class CarLoadingState extends CarState {}
class CarLoadedState extends CarState {
  final List<Car> cars;
}
class CarErrorState extends CarState {
  final String message;
}
```

States represent the current status of the app (loading, loaded with data, or error).

#### BLoC ([car_bloc.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/bloc/car_bloc.dart))

```dart
class CarBloc extends Bloc<CarEvent, CarState> {
  final GetCars getCars;

  CarBloc({required this.getCars}) : super(CarLoadingState()) {
    on<LoadCarsEvent>((event, emit) async {
      emit(CarLoadingState());
      try {
        final cars = await getCars.call();
        emit(CarLoadedState(cars: cars));
      } catch (e) {
        emit(CarErrorState(message: e.toString()));
      }
    });
  }
}
```

**How it works:**
1. User opens the app â†’ `LoadCarsEvent` is triggered
2. BLoC emits `CarLoadingState` (shows loading spinner)
3. BLoC calls the `GetCars` use case
4. On success â†’ emits `CarLoadedState` with car data
5. On error â†’ emits `CarErrorState` with error message

---

## ğŸ”§ Dependency Injection

The app uses **GetIt** for dependency injection to manage object creation and dependencies.

**Setup:** [injection_container.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/injection_container.dart)

```dart
GetIt getIt = GetIt.instance;

void initInjection() {
  // Register Firebase instance
  getIt.registerLazySingleton<FirebaseFirestore>(
    () => FirebaseFirestore.instance,
  );
  
  // Register Data Source
  getIt.registerLazySingleton<FirebaseDataCarSource>(
    () => FirebaseDataCarSource(firestore: getIt<FirebaseFirestore>()),
  );
  
  // Register Repository
  getIt.registerLazySingleton<CarRepository>(
    () => CarRepositoryImp(getIt<FirebaseDataCarSource>()),
  );
  
  // Register Use Case
  getIt.registerLazySingleton<GetCars>(
    () => GetCars(carRepository: getIt<CarRepository>()),
  );
  
  // Register BLoC (Factory - new instance each time)
  getIt.registerFactory(() => CarBloc(getCars: getIt<GetCars>()));
}
```

**Benefits:**
- **Decoupling** - Components don't create their own dependencies
- **Testability** - Easy to mock dependencies for testing
- **Maintainability** - Centralized dependency management

---

## ğŸ“Š Data Flow

Here's how data flows through the app when loading cars:

```mermaid
sequenceDiagram
    participant UI as UI (CarListScreen)
    participant BLoC as CarBloc
    participant UC as GetCars UseCase
    participant Repo as CarRepository
    participant DS as FirebaseDataCarSource
    participant FB as Firebase Firestore

    UI->>BLoC: LoadCarsEvent
    BLoC->>BLoC: emit(CarLoadingState)
    BLoC->>UC: call()
    UC->>Repo: getCars()
    Repo->>DS: getCars()
    DS->>FB: collection('cars').get()
    FB-->>DS: QuerySnapshot
    DS->>DS: Convert to List<Car>
    DS-->>Repo: List<Car>
    Repo-->>UC: List<Car>
    UC-->>BLoC: List<Car>
    BLoC->>BLoC: emit(CarLoadedState)
    BLoC-->>UI: Update UI with cars
```

---

## ğŸ“¦ Packages Used

### Core Dependencies ([pubspec.yaml](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/pubspec.yaml))

| Package | Version | Purpose |
|---------|---------|---------|
| `firebase_core` | ^2.23.0 | Firebase initialization |
| `cloud_firestore` | ^4.14.0 | Cloud database operations |
| `flutter_bloc` | ^8.1.3 | BLoC state management |
| `bloc` | ^8.1.3 | Core BLoC library |
| `get_it` | ^7.6.6 | Dependency injection |
| `flutter_map` | ^4.0.0 | Map integration (future feature) |
| `latlong2` | ^0.8.0 | Geographic coordinates |

---

## ğŸ¨ UI/UX Design

### Design System

**Color Palette:**
- Background: `#1A1A1A` (Deep Charcoal)
- Card Background: `#2A2A2E` (Charcoal Gray)
- Accent: `#D1122C` (Brake Caliper Red)
- Text Primary: `#FFFFFF` (White)
- Text Secondary: `#A3ACB3` (Steel Gray)

### Key UI Components

#### 1. **Onboarding Page**

Beautiful full-screen background with gradient overlay featuring:
- Premium car imagery
- Responsive layout (Portrait & Landscape)
- Call-to-action button
- Dark theme with white text for contrast

#### 2. **Car Card**

Each car is displayed in a premium card with:
- Full cover image background
- Gradient overlay for text readability
- Favorite heart icon (top-right)
- Car model name
- Distance and fuel capacity icons
- Price badge with gradient (bottom-right)
- Tap gesture to view details

**Implementation:** [car_card.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/widgets/car_card.dart)

#### 3. **Category Chips**

Horizontal scrolling chips for category selection:
- Selected: Red background with white text
- Unselected: Gray background with steel text
- Border highlight on selection

---

## ğŸ’¡ Key Implementation Details

### 1. **Cache-Busting for Images**

When images are updated in Firebase, browsers/apps cache the old version. To fix this, we add a timestamp to the URL:

[car.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/data/models/car.dart#L36-L44)

```dart
static String _addCacheBuster(String url) {
  if (url.isEmpty) return url;
  final separator = url.contains('?') ? '&' : '?';
  return '$url${separator}v=${DateTime.now().millisecondsSinceEpoch}';
}
```

This ensures every time the app loads, it fetches the latest image from Firebase.

### 2. **Error Handling**

The app gracefully handles different states:
- **Loading:** Shows circular progress indicator
- **Error:** Displays error icon, message, and retry button
- **Empty:** Shows "No cars available" message
- **Success:** Renders car list

### 3. **Image Fallback**

If a network image fails to load, the app displays a local fallback image:

```dart
Image.network(
  car.imageUrl,
  errorBuilder: (context, error, stackTrace) {
    return Image.asset("assets/car_image.png", fit: BoxFit.cover);
  },
)
```

---

## ğŸ” Code Structure Walkthrough

### Project Directory Structure

```
lib/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ datasource/
â”‚   â”‚   â””â”€â”€ firebase_data_car_source.dart    # Firebase API calls
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ car.dart                         # Car data model
â”‚   â””â”€â”€ repositories/
â”‚       â””â”€â”€ car_repository_imp.dart          # Repository implementation
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ car_repository.dart              # Repository interface
â”‚   â””â”€â”€ usecases/
â”‚       â””â”€â”€ get_cars.dart                    # Business logic
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ bloc/
â”‚   â”‚   â”œâ”€â”€ car_bloc.dart                    # BLoC logic
â”‚   â”‚   â”œâ”€â”€ car_event.dart                   # Events
â”‚   â”‚   â””â”€â”€ car_state.dart                   # States
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ onboarding_page.dart             # Welcome screen
â”‚   â”‚   â”œâ”€â”€ car_list_screen.dart             # Main screen
â”‚   â”‚   â”œâ”€â”€ car_details_page.dart            # Details screen
â”‚   â”‚   â”œâ”€â”€ car_search_page.dart             # Search screen
â”‚   â”‚   â””â”€â”€ favorite_cars_page.dart          # Favorites screen
â”‚   â””â”€â”€ widgets/
â”‚       â”œâ”€â”€ car_card.dart                    # Reusable car card
â”‚       â””â”€â”€ more_car_cards.dart              # Additional cards
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ add_sample_data.dart                 # Sample data seeding
â”œâ”€â”€ firebase_options.dart                     # Firebase config
â”œâ”€â”€ injection_container.dart                  # Dependency injection
â””â”€â”€ main.dart                                 # App entry point
```

### File Explanations

#### [main.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/main.dart)
**Purpose:** App entry point

**Key responsibilities:**
- Initialize Flutter bindings
- Initialize Firebase
- Setup dependency injection
- Run the app with `MyApp` widget
- Set initial route to `OnboardingPage`

---

#### [car.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/data/models/car.dart)
**Purpose:** Data model representing a car

**Fields:**
- `model` - Car name (e.g., "Porsche 911 Turbo S")
- `category` - Car type (e.g., "Sports Car")
- `price` - Hourly rental price
- `maxSpeed` - Top speed
- `acceleration` - 0-100 km/h time
- `transmission` - Transmission type
- `seats` - Number of seats
- `fuelCapacity` - Fuel tank size
- `distance` - Distance from user
- `imageUrl` - Car image URL
- `ownerName`, `ownerPhone`, `ownerRating`, `ownerReviews` - Owner info

**Key method:**
- `fromMap()` - Factory constructor to create Car from Firestore document
- `_addCacheBuster()` - Prevents image caching issues

---

#### [firebase_data_car_source.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/data/datasource/firebase_data_car_source.dart)
**Purpose:** Direct Firebase data access

```dart
class FirebaseDataCarSource {
  final FirebaseFirestore _firestore;

  Future<List<Car>> getCars() async {
    var snapshot = await _firestore.collection('cars').get();
    return snapshot.docs.map((doc) => Car.fromMap(doc.data())).toList();
  }
}
```

**Responsibility:** Fetch cars from Firestore and convert to `Car` objects.

---

#### [car_repository_imp.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/data/repositories/car_repository_imp.dart)
**Purpose:** Implements the repository interface

Acts as a bridge between the domain layer and data source.

---

#### [get_cars.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/domain/usecases/get_cars.dart)
**Purpose:** Use case for getting cars

```dart
class GetCars {
  final CarRepository carRepository;

  Future<List<Car>> call() async {
    return await carRepository.getCars();
  }
}
```

**Why separate use cases?**
- Encapsulates business logic
- Reusable across different parts of the app
- Easy to test in isolation

---

#### [car_list_screen.dart](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/lib/presentation/pages/car_list_screen.dart)
**Purpose:** Main screen displaying car list

**Features:**
- BLoC integration with `BlocProvider` and `BlocBuilder`
- Category filtering with chips
- Favorites state management
- Bottom navigation
- Custom header with back button
- Handles loading, error, and empty states

**State Management:**
```dart
BlocBuilder<CarBloc, CarState>(
  builder: (context, state) {
    if (state is CarLoadingState) {
      return _buildLoadingUI();
    } else if (state is CarErrorState) {
      return _buildErrorUI(state.message);
    } else if (state is CarLoadedState) {
      return _buildCarList(state.cars);
    }
  },
)
```

---

## ğŸ“ Exam Talking Points

### Architecture Benefits
> "I chose Clean Architecture because it provides clear separation between business logic, data access, and UI. This makes the code more testable, maintainable, and scalable. Each layer has a single responsibility."

### Firebase Choice
> "Firebase Firestore was the ideal choice because it eliminates the need for a backend server, provides real-time updates, and has excellent Flutter integration. It also supports offline caching automatically."

### BLoC Pattern
> "I implemented the BLoC pattern for state management because it separates business logic from the UI, makes the app reactive to state changes, and follows best practices in Flutter development. The stream-based approach ensures clean data flow."

### Dependency Injection
> "Using GetIt for dependency injection makes the code more modular and testable. Dependencies are injected rather than created within classes, which follows the Dependency Inversion Principle from SOLID."

### UI/UX Design
> "The dark theme with red accents creates a premium, automotive feel that matches the luxury car brand aesthetic. The gradient overlays ensure text readability while maintaining visual appeal."

---

## ğŸ› Challenges Faced & Solutions

### Challenge 1: Favorites State Consistency
**Problem:** Favorites weren't syncing between screens

**Solution:** Pass the favorites `Set` as a parameter to child screens and update the parent on return:
```dart
Navigator.push(...).then((_) {
  setState(() {}); // Refresh parent screen
});
```

### Challenge 2: Firebase Image Caching
**Problem:** Updated images in Firebase weren't showing in the app

**Solution:** Implemented cache-busting by adding timestamp query parameter to image URLs

### Challenge 3: Category Filtering
**Problem:** Needed to filter cars dynamically based on user selection

**Solution:** Added category field to Car model and filtered list in real-time:
```dart
final filteredCars = _selectedCategory == 'All'
    ? cars
    : cars.where((car) => car.category == _selectedCategory).toList();
```

---

## ğŸ“¸ App Screenshots

![Onboarding Screen](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/screenshots/Onboarding%20(2).png)

![Home Screen with Car List](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/screenshots/HomeScreen.png)

![Car Details Page](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/screenshots/Detailspage.png)

![Booking Details](file:///c:/Users/21655/Desktop/Dev%20Mobile/flutter/First_app/Strada-Lusso/screenshots/Details_of_booking.png)

---

## âœ… What I Learned

1. **Clean Architecture** - How to structure a Flutter app with proper separation of concerns
2. **Firebase Integration** - Setting up and using Cloud Firestore in Flutter
3. **State Management** - Implementing BLoC pattern for reactive UI
4. **Dependency Injection** - Using GetIt for better code organization
5. **UI/UX Design** - Creating premium, dark-themed mobile interfaces
6. **Error Handling** - Managing loading, error, and empty states gracefully
7. **Navigation** - Implementing multi-screen navigation with state passing

---

## ğŸš€ Future Enhancements

- [ ] Implement My Rentals feature with booking history
- [ ] Add user authentication (Firebase Auth)
- [ ] Integrate map view to show car locations
- [ ] Add car comparison feature
- [ ] Implement push notifications for new listings
- [ ] Add payment integration
- [ ] Support multiple languages (i18n)
- [ ] Add animations and transitions

---

## ğŸ“š Key Takeaways for Exam

1. **Architecture is crucial** - Clean Architecture makes the codebase maintainable and scalable
2. **State management** - BLoC provides predictable state changes and separates logic from UI
3. **Firebase is powerful** - No-code backend solution with real-time capabilities
4. **Dependency Injection** - Essential for testability and loose coupling
5. **User experience matters** - Loading states, error handling, and smooth navigation are critical

---

**Good luck with your exam! ğŸ“**
